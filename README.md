# Lathe-on-PSOC ( Electronic Leadscrew )
Электронная гитара на PSOC CY8CKIT-049-42xx

Идея и алгоритмы:
- "Управление токарным на Atmega" https://www.chipmaker.ru/topic/97701/
- "Еще одна электронная гитара для токарника, на Ардуино" https://www.chipmaker.ru/topic/97701/

Для этого проекта ставились задачи:
- только набор минимальных функций
- простота реализации
- снять ограничения atmeg-и

Использованный алгоритм синхронизации нужен при:
- относительно низкая стабильность вращения двигателя(недорогие станки)
- большое число импульсов от энкодера(чем больше, тем лучше)
- не имеет смысл делать полный ЧПУ (иначе, замена всех винтов, для устранения люфтов)

Основные компоненты:
- шаговый двигатель NEMA 34
- энкодер E6B2-CWZ5B OMRON 2000P/R
- драйвер Leadshine DMA860H Driver DC 24-80V
- CY8CKIT-049-42xx
- LCD 20x4
- PSoC® Creator™ Integrated Design Environment (IDE)

Настройки в main.h:
- #define Screw_mm                2.0 //шаг винта
- #define Motor_Z_Step_Per_Rev    200 // Кол-во шагов/об
- #define QUAD_RES                2000//энкодер дел/об
- #define MicroStep_Z             2   // Микрошаг
- #define ACCEL                   20  // accel* steps ???
- #define QUAD_MAX                (QUAD_RES*4)
- #define STEP_PER_MM        		  ((Motor_Z_Step_Per_Rev*MicroStep_Z)/Screw_mm) //400
- #define TICK_PER_STEP_MM        (QUAD_MAX/STEP_PER_MM) //200=0.005mm

Проблемы:
- из-за люфта показания неточные
- подклинивание ШД при больших оборотах и подачах
- устранение подклинивания акселерацией ограничено длиной разгона

Тест диапазона частот на входе драйвера от DDS:
Шаг/об    Стартовая   Максимальная
400       2500        7500
800       5000        20000
1600      10000       50000
*Стартовая - макс. частота пуска
*Максимальная - макс. устойчивая частота вращения

